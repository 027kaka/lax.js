"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){var u,c,l,W,C,S,e=(u=["perspective","scaleX","scaleY","scale","skewX","skewY","skew","rotateX","rotateY","rotate"],c=["blur","hue-rotate","brightness"],l=["translateX","translateY","translateZ"],W=["perspective","border-radius","blur","translateX","translateY","translateZ"],C=["hue-rotate","rotate","rotateX","rotateY","skew","skewX","skewY"],S={easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},easeOutBounce:function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInBounce:function(e){return 1-S.easeOutBounce(1-e)},easeOutBack:function(e){return 1+2.70158*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2)},easeInBack:function(e){return 2.70158*e*e*e-1.70158*e*e}},new function e(){var o=this;_classCallCheck(this,e),_defineProperty(this,"drivers",[]),_defineProperty(this,"elements",[]),_defineProperty(this,"frame",0),_defineProperty(this,"debug",!1),_defineProperty(this,"windowWidth",0),_defineProperty(this,"windowHeight",0),_defineProperty(this,"presets",{}),_defineProperty(this,"debugData",{frameLengths:[]}),_defineProperty(this,"init",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};o.presets=e,o.findAndAddElements(),window.requestAnimationFrame(o.onAnimationFrame),o.windowWidth=document.body.clientWidth,o.windowHeight=document.body.clientHeight,window.onresize=o.onWindowResize}),_defineProperty(this,"onWindowResize",function(){document.body.clientWidth===o.windowWidth&&document.body.clientHeight===o.windowHeight||(o.windowWidth=document.body.clientWidth,o.windowHeight=document.body.clientHeight,o.elements.forEach(function(e){return e.calculateTransforms()}))}),_defineProperty(this,"onAnimationFrame",function(e){o.debug&&(o.debugData.frameStart=Date.now());var t,n={};o.drivers.forEach(function(e){n[e.name]=e.getValue(o.frame)}),o.elements.forEach(function(e){e.update(n,o.frame)}),o.debug&&o.debugData.frameLengths.push(Date.now()-o.debugData.frameStart),o.frame%60==0&&o.debug&&(t=Math.ceil(o.debugData.frameLengths.reduce(function(e,t){return e+t},0)/60),console.log("Average frame calculation time: ".concat(t,"ms")),o.debugData.frameLengths=[]),o.frame++,window.requestAnimationFrame(o.onAnimationFrame)}),_defineProperty(this,"addDriver",function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};o.drivers.push(new a(e,t,n))}),_defineProperty(this,"removeDriver",function(t){o.drivers=o.drivers.filter(function(e){return e.name!==t})}),_defineProperty(this,"findAndAddElements",function(){o.elements=[],document.querySelectorAll("[data-lax]").forEach(function(e){var t=Function("return ".concat(e.getAttribute("data-lax")))();o.elements.push(new d("[data-lax]",o,e,t,0,{}))})}),_defineProperty(this,"addElements",function(n,r,a){document.querySelectorAll(n).forEach(function(e,t){o.elements.push(new d(n,o,e,r,t,a))})}),_defineProperty(this,"removeElements",function(t){o.elements.filter(function(e){return e.selector!==t})}),_defineProperty(this,"addElement",function(e,t,n){o.elements.push(new d("",o,e,t,0,n))}),_defineProperty(this,"removeElement",function(t){o.elements=o.elements.filter(function(e){return e.domElement!==t})})});function f(e){var t=0<arguments.length&&void 0!==e?e:"";return""===t?void 0:t}function m(e,t){if(Array.isArray(e))return e;for(var n=Object.keys(e).map(function(e){return parseInt(e)}).sort(function(e,t){return t<e?1:-1}),r=n[n.length-1],a=0;a<n.length;a++){var o=n[a];if(t<o){r=o;break}}return e[r]}function h(e,t,n){var r=t.width,a=t.height,o=t.x,i=t.y;if("number"==typeof e)return e;var s=document.body.scrollHeight,u=document.body.scrollWidth,c=window.innerWidth,l=window.innerHeight,d=document.body.scrollTop,f=o+document.body.scrollLeft,m=f+r,h=i+d,p=h+a;return Function("return ".concat(e.replace(/screenWidth/g,c).replace(/screenHeight/g,l).replace(/pageHeight/g,s).replace(/pageWidth/g,u).replace(/elWidth/g,r).replace(/elHeight/g,a).replace(/elInY/g,h-l).replace(/elOutY/g,p).replace(/elCenterY/g,h+a/2-l/2).replace(/elInX/g,f-c).replace(/elOutX/g,m).replace(/elCenterX/g,f+r/2-c/2).replace(/index/g,n)))()}function a(e,t){var r=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,a),_defineProperty(this,"getValueFn",void 0),_defineProperty(this,"name",""),_defineProperty(this,"lastValue",0),_defineProperty(this,"frameStep",1),_defineProperty(this,"m1",0),_defineProperty(this,"m2",0),_defineProperty(this,"momentum",0),_defineProperty(this,"momentumEnabled",!1),_defineProperty(this,"getValue",function(e){var t,n=r.lastValue;return e%r.frameStep==0&&(n=r.getValueFn()),r.momentumEnabled&&(t=n-r.lastValue,r.m1=.8*r.m1+t*(1-.8),r.m2=.8*r.m2+r.m1*(1-.8),r.momentum=Math.round(5e3*r.m2)/1e4),r.lastValue=n,[r.lastValue,r.momentum]}),this.name=e,this.getValueFn=t,Object.keys(n).forEach(function(e){r[e]=n[e]}),this.lastValue=this.getValueFn()}function d(e,t,n,r){var T=this,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{};_classCallCheck(this,d),_defineProperty(this,"domElement",void 0),_defineProperty(this,"transformsData",void 0),_defineProperty(this,"styles",{}),_defineProperty(this,"selector",""),_defineProperty(this,"groupIndex",0),_defineProperty(this,"laxInstance",void 0),_defineProperty(this,"update",function(e,t){var n=T.transforms,r={};for(var a in n){var o=n[a];e[a]||console.error("No lax driver with name: ",a);var i=_slicedToArray(e[a],2),s=i[0],u=i[1];for(var c in o){var l,d,f,m,h=_slicedToArray(o[c],3),p=h[0],y=h[1],g=h[2],v=void 0===g?{}:g,b=v.modValue,_=v.frameStep,w=void 0===_?1:_,P=v.easing,A=v.momentum,I=v.momentumMode,E=v.cssFn,x=v.cssUnit,O=void 0===x?"":x,k=S[P];t%w==0&&(l=function(e,t,n,r){var a=0;if(e.forEach(function(e){e<n&&a++}),a<=0)return t[0];if(a>=e.length)return t[e.length-1];var o,i,s,u,c,l=a-1,d=(o=e[l],i=e[a],(n-o)/(i-o));return r&&(d=r(d)),s=t[l],u=t[a],s*(1-(c=d))+u*c}(p,y,b?s%b:s,k),A&&(d=u*A,"absolute"===I&&(d=Math.abs(d)),l+=d),f="px"==(O||W.includes(c)?"px":C.includes(c)?"deg":"")?0:3,m=l.toFixed(f),r[c]=E?E(m):m+O)}}T.applyStyles(r)}),_defineProperty(this,"calculateTransforms",function(){T.transforms={};var l=T.laxInstance.windowWidth;for(var e in T.transformsData)!function(e){var d=T.transformsData[e],c={},t=d.presets;(void 0===t?[]:t).forEach(function(e){var t,n,r,a,o,i=_slicedToArray(e.split(" "),2),s=i[0],u=i[1],c=void 0===u?"":u,l=T.laxInstance.presets[s];l?(n=(t=_slicedToArray(c.split(","),3))[0],r=t[1],a=t[2],o=l(f(n),f(r),a),Object.keys(o).forEach(function(e){d[e]=o[e]})):console.error("Lax preset cannot be found with name: ",s)}),delete d.presets;for(var n in d)!function(e){var t=_slicedToArray(d[e],3),n=t[0],r=t[1],a=t[2],o=void 0===a?{}:a,i=T.domElement.getBoundingClientRect(),s=m(n,l).map(function(e){return h(e,i,T.groupIndex)}),u=m(r,l).map(function(e){return h(e,i,T.groupIndex)});c[e]=[s,u,o]}(n);T.transforms[e]=c}(e)}),_defineProperty(this,"applyStyles",function(e){var r,a,o,t=(r=e,a={transform:"",filter:""},o={translateX:0,translateY:0,translateZ:0},Object.keys(r).forEach(function(e){var t=r[e],n=W.includes(e)?"px":C.includes(e)?"deg":"";l.includes(e)?o[e]=t:u.includes(e)?a.transform+="".concat(e,"(").concat(t).concat(n,") "):c.includes(e)?a.filter+="".concat(e,"(").concat(t).concat(n,") "):a[e]="".concat(t).concat(n," ")}),a.transform="translate3d(".concat(o.translateX,"px, ").concat(o.translateY,"px, ").concat(o.translateZ,"px) ").concat(a.transform),a);Object.keys(t).forEach(function(e){T.domElement.style.setProperty(e,t[e])})}),this.selector=e,this.laxInstance=t,this.domElement=n,this.transformsData=r,this.groupIndex=a;var i=o.style,s=void 0===i?{}:i;Object.keys(s).forEach(function(e){n.style.setProperty(e,s[e])}),this.calculateTransforms()}"undefined"!=typeof module&&void 0!==module.exports?module.exports=e:window.lax=e}();