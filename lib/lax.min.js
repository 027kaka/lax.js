"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){var s,c,l,d,I,e=(s=["perspective","translateX","translateY","translate","scaleX","scaleY","scale","skewX","skewY","skew","rotateX","rotateY","rotate"],c=["blur","hue-rotate","brightness"],l=["perspective","translateX","translateY","translate","border-radius","blur"],d=["hue-rotate","rotate","rotateX","rotateY","skew","skewX","skewY"],I={easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},easeOutBounce:function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInBounce:function(e){return 1-I.easeOutBounce(1-e)},easeOutBack:function(e){return 1+2.70158*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2)},easeInBack:function(e){return 2.70158*e*e*e-1.70158*e*e}},new function e(){var a=this;_classCallCheck(this,e),_defineProperty(this,"drivers",[]),_defineProperty(this,"elements",[]),_defineProperty(this,"frame",0),_defineProperty(this,"debug",!1),_defineProperty(this,"windowWidth",0),_defineProperty(this,"windowHeight",0),_defineProperty(this,"presets",{}),_defineProperty(this,"debugData",{frameLengths:[]}),_defineProperty(this,"init",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a.addDriver("frame",function(){return a.frame}),a.presets=e,a.findAndAddElements(),window.requestAnimationFrame(a.onAnimationFrame),a.windowWidth=document.body.clientWidth,a.windowHeight=document.body.clientHeight,window.onresize=a.onWindowResize}),_defineProperty(this,"onWindowResize",function(){document.body.clientWidth===a.windowWidth&&document.body.clientHeight===a.windowHeight||(a.windowWidth=document.body.clientWidth,a.windowHeight=document.body.clientHeight,a.elements.forEach(function(e){return e.calculateAnimations()}))}),_defineProperty(this,"onAnimationFrame",function(e){a.debug&&(a.debugData.frameStart=Date.now());var t,n={};a.drivers.forEach(function(e){n[e.name]=e.getValue(a.frame)}),a.elements.forEach(function(e){e.update(n,a.frame)}),a.debug&&a.debugData.frameLengths.push(Date.now()-a.debugData.frameStart),a.frame%60==0&&a.debug&&(t=Math.ceil(a.debugData.frameLengths.reduce(function(e,t){return e+t},0)/60),console.log("Average frame calculation time: ".concat(t,"ms")),a.debugData.frameLengths=[]),a.frame++,window.requestAnimationFrame(a.onAnimationFrame)}),_defineProperty(this,"addDriver",function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};a.drivers.push(new i(e,t,n))}),_defineProperty(this,"removeDriver",function(t){a.drivers=a.drivers.filter(function(e){return e.name!==t})}),_defineProperty(this,"findAndAddElements",function(){a.elements=[],document.querySelectorAll("[data-lax]").forEach(function(e){var t=Function("return ".concat(e.getAttribute("data-lax")))();a.elements.push(new h("[data-lax]",a,e,t,0,{}))})}),_defineProperty(this,"addElements",function(n,r,i){document.querySelectorAll(n).forEach(function(e,t){a.elements.push(new h(n,a,e,r,t,i))})}),_defineProperty(this,"removeElements",function(t){a.elements.filter(function(e){return e.selector!==t})})});function f(e){var t=0<arguments.length&&void 0!==e?e:"";return""===t?void 0:t}function E(e,t,n,r){var i=0;if(e.forEach(function(e){e<n&&i++}),i<=0)return t[0];if(i>=e.length)return t[e.length-1];var a,o,u,s,c,l=i-1,d=(a=e[l],o=e[i],(n-a)/(o-a));return r&&(d=r(d)),u=t[l],s=t[i],u*(1-(c=d))+s*c}function m(e,t,n){var r=t.width,i=t.height,a=t.x,o=t.y;if("number"==typeof e)return e;var u=document.body.clientWidth,s=document.body.clientHeight,c=document.body.scrollTop,l=a+document.body.scrollLeft,d=l+r,f=o+c,m=f+i;return Function("return ".concat(e.replace(/screenWidth/g,u).replace(/screenHeight/g,s).replace(/elWidth/g,r).replace(/elHeight/g,i).replace(/elInBottom/g,f-s).replace(/elOutTop/g,m).replace(/elCenterVert/g,f+i/2-s/2).replace(/elInRight/g,l-u).replace(/elOutLeft/g,d).replace(/elCenterHoriz/g,l+r/2-u/2).replace(/index/g,n)))()}function i(e,t){var r=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,i),_defineProperty(this,"getValueFn",void 0),_defineProperty(this,"name",""),_defineProperty(this,"lastValue",0),_defineProperty(this,"frameStep",1),_defineProperty(this,"m1",0),_defineProperty(this,"m2",0),_defineProperty(this,"momentum",0),_defineProperty(this,"momentumEnabled","off"),_defineProperty(this,"getValue",function(e){var t,n=r.lastValue;return e%r.frameStep==0&&(n=r.getValueFn()),"off"!==r.momentumEnabled&&(t=n-r.lastValue,r.m1=.8*r.m1+t*(1-.8),r.m2=.8*r.m2+r.m1*(1-.8),r.momentum=Math.round(5e3*r.m2)/1e4,"absolute"===r.momentumEnabled&&(r.momentum=Math.abs(r.momentum))),r.lastValue=n,[r.lastValue,r.momentum]}),this.name=e,this.getValueFn=t,Object.keys(n).forEach(function(e){r[e]=n[e]}),this.lastValue=this.getValueFn()}function h(e,t,n,r){var A=this,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{};_classCallCheck(this,h),_defineProperty(this,"domElement",void 0),_defineProperty(this,"animationsData",void 0),_defineProperty(this,"styles",{}),_defineProperty(this,"selector",""),_defineProperty(this,"groupIndex",0),_defineProperty(this,"laxInstance",void 0),_defineProperty(this,"update",function(e,t){var n=A.animations,r={};for(var i in n){var a=n[i];e[i]||console.error("No lax driver with name: ",i);var o=_slicedToArray(e[i],2),u=o[0],s=o[1];for(var c in a){var l,d=_slicedToArray(a[c],3),f=d[0],m=d[1],h=d[2],p=void 0===h?{}:h,y=p.loopFrame,g=p.frameStep,v=void 0===g?1:g,b=p.easing,_=p.momentum,w=p.cssFn,P=I[b];t%v==0&&(l=E(f,m,y?u%y:u,P),_&&(l+=s*_),r[c]=w?w(l):l)}}A.applyStyles(r)}),_defineProperty(this,"calculateAnimations",function(){A.animations={};function e(e){var d=A.animationsData[e],c={},t=d.presets;function n(e){var t=_slicedToArray(d[e],3),n=t[0],r=t[1],i=t[2],a=void 0===i?{}:i,o=A.domElement.getBoundingClientRect(),u=n.map(function(e){return m(e,o,A.groupIndex)}),s=r.map(function(e){return m(e,o,A.groupIndex)});c[e]=[u,s,a]}for(var r in(void 0===t?[]:t).forEach(function(e){var t,n,r,i,a,o=_slicedToArray(e.split(" "),2),u=o[0],s=o[1],c=void 0===s?"":s,l=A.laxInstance.presets[u];l?(n=(t=_slicedToArray(c.split(","),3))[0],r=t[1],i=t[2],a=l(f(n),f(r),i),Object.keys(a).forEach(function(e){d[e]=a[e]})):console.error("Lax preset cannot be found with name: ",u)}),delete d.presets,d)n(r);A.animations[e]=c}for(var t in A.animationsData)e(t)}),_defineProperty(this,"applyStyles",function(e){var r,i,t=(r=e,i={transform:"",filter:""},Object.keys(r).forEach(function(e){var t=r[e],n=l.includes(e)?"px":d.includes(e)?"deg":"";s.includes(e)?i.transform+="".concat(e,"(").concat(t).concat(n,") "):c.includes(e)?i.filter+="".concat(e,"(").concat(t).concat(n,") "):i[e]="".concat(t).concat(n," ")}),i);Object.keys(t).forEach(function(e){A.domElement.style[e]=t[e]})}),this.selector=e,this.laxInstance=t,this.domElement=n,this.animationsData=r,this.groupIndex=i;var o=a.transition,u=a.willChange;o&&(n.style.transition=o),u&&(n.style.willChange=u),this.calculateAnimations()}"undefined"!=typeof module&&void 0!==module.exports?module.exports=e:window.lax=e}();